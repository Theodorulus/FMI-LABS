3. Schițați schema entitate-relație corespunzătoare.

Este poza cu schema entitate-relație atașată mail-ului.

10. De câte ori a împrumutat un membru (nume și prenume) fiecare exemplar (cod) al unui film (titlu)?

select last_name || ' ' || first_name "Nume", t.title, tc.copy_id "Nr. Copie" , count(*) "Nr. imprumutari"
from member m join rental r on (m.member_id = r.member_id)
              join title t on (t.title_id = r.title_id)
              join title_copy tc on (t.title_id = tc.title_id)
group by m.member_id, last_name, first_name, t.title, tc.copy_id
order by m.member_id, t.title;

11. Obțineți statusul celui mai des împrumutat exemplar al fiecărui film (titlu).

select t.title, tc.copy_id, tc.status, count(tc.copy_id) "Numar imprumuturi"
from title t join title_copy tc on (t.title_id = tc.title_id)
            join rental r on (tc.title_id = r.title_id and tc.copy_id = r.copy_id)
group by t.title, tc.copy_id, tc.status
order by t.title, tc.copy_id;

Nu stiu cum fac sa aflu care este cel mai imprumutat exemplar al fiecarui film, dar am afisat pentru fiecare exemplar al fiecarui film statusul.

12. 
a.

select book_date, count(*) 
from rental
where to_number(to_char(book_date, 'dd')) <= 2
      and to_char(book_date, 'mm') = to_char(sysdate, 'mm')
group by book_date;

b.

select to_char(book_date,'dd/mm/yyyy') Ziua, count(*) "Nr. Imprumuturi"
from rental
where to_char(book_date, 'mm') = to_char(sysdate, 'mm')
      and book_date in (select book_date from rental)
group by to_char(book_date,'dd/mm/yyyy')
order by to_char(book_date,'dd/mm/yyyy');

c.

select to_char(z.ziua, 'dd/mm/yyyy') "Ziua" , count(r.book_date) "Nr imprumuturi"
from rental r right join (select trunc(sysdate, 'month') + level -1 ziua
                          from dual
                          connect by level <= extract (day from last_day(sysdate))
                          ) z 
                          on (to_char(r.book_date, 'dd/mm/yyyy') = to_char(z.ziua, 'dd/mm/yyyy'))
group by to_char(z.ziua, 'dd/mm/yyyy')
order by to_char(z.ziua, 'dd/mm/yyyy');